# AIBetExplorer - Краткое описание проекта

## Назначение

Система для прогнозирования ставок на спортивные события (преимущественно футбольные матчи) с использованием статистики уже сыгранных матчей.

## Основная функциональность

1. **Загрузка данных**: Система загружает статистику с сайта http://betexplorer.com/
2. **Парсинг и анализ**: Разбор HTML-страниц и извлечение данных о матчах, командах, чемпионатах
3. **Накопление данных**: Сохранение статистики в базе данных PostgreSQL
4. **Прогнозирование**: Расчет вероятностей исходов матчей на основе накопленной статистики
5. **Расчет ставок**: Определение наиболее выгодных ставок на матч с использованием критерия Келли

## Поддерживаемые виды спорта

- Футбол (Football)
- Баскетбол (Basketball)
- Хоккей (Hockey)
- Теннис (Tennis)
- Бейсбол (Baseball)
- Волейбол (Volleyball)
- Гандбол (Handball)

## Основные компоненты

### Модуль загрузки данных (app/betexplorer/)
- **betexplorer.py**: Основной модуль для загрузки и парсинга данных с BetExplorer
- **models.py**: SQLAlchemy модели базы данных
- **schemas.py**: Типизированные структуры данных (TypedDict)
- **crud.py**: Операции CRUD с базой данных

### Модуль анализа (app/fbcup/)
- **analysis.py**: Анализ ставок при различных параметрах
- **forecast.py**: Расчет предсказаний результатов матчей
- **bet.py**: Расчет ставок по критерию Келли
- **statistic.py**: Расчет предматчевой статистики
- **rating.py**: Расчет рейтингов команд
- **bet_summary.py**: Итоги ставок на матчи
- **analys_config.py**: Параметры конфигурации расчета ставок

### Инфраструктура
- **database.py**: Менеджер сессий базы данных (SQLAlchemy Async)
- **utilbase.py**: Утилиты для загрузки/сохранения данных (HTTP, файловая система)
- **main.py**: Точка входа для загрузки данных
- **analysis.py**: Точка входа для анализа данных

## База данных

**СУБД**: PostgreSQL 15+ (основная), SQLite (для тестов)

**Основные таблицы**:
- `sport` - Виды спорта
- `country` - Страны
- `country_sport` - Связь стран и видов спорта
- `championship` - Чемпионаты
- `championship_stage` - Стадии чемпионатов
- `team` - Команды
- `match` - Матчи
- `time_score` - Результаты по таймам
- `shooter` - Информация о голах
- `match_event` - События в матче (обе забьют, тотал, фора)

## Технологический стек

- **Язык**: Python 3.14 (требуется только эта версия)
- **Асинхронность**: asyncio, aiohttp, aiofiles
- **ORM**: SQLAlchemy (async)
- **Парсинг**: selectolax
- **Анализ данных**: polars, pandera
- **Тестирование**: pytest, pytest-asyncio
- **Линтинг**: ruff
- **База данных**: PostgreSQL 15+ (asyncpg), SQLite (aiosqlite)

## Конфигурация

Основные настройки находятся в `app/config_new.py`:
- Подключение к базе данных
- Каталоги для загрузки данных
- Виды спорта для обработки
- Параметры загрузки (из сети или с диска)
- Параметры многопроцессорной обработки

## Режимы работы

1. **DATABASE_NOT_USE (0)**: База данных не используется
2. **DATABASE_READ_ONLY (1)**: Только чтение из базы данных
3. **DATABASE_WRITE_DATA (2)**: Чтение и запись в базу данных

## Текущее состояние

Проект находится в активной разработке. Основной функционал загрузки и анализа данных реализован, но требует доработки и оптимизации.
